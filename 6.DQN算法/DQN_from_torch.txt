D:\anaconda3\envs\gymna\python.exe D:\code\python\Simple_Reinforcement_Learning\6.DQN算法\QDN_simple.py
Using GPU: NVIDIA GeForce RTX 2060 with 1 GPUs
Episode 0 finished after 22 timesteps with reward 22.00
Episode 0 complete with total reward 22.00
Target network updated at episode 0
Episode 1 finished after 44 timesteps with reward 44.00
Episode 2 finished after 18 timesteps with reward 18.00
Episode 3 finished after 34 timesteps with reward 34.00
Episode 4 finished after 33 timesteps with reward 33.00
Episode 5 finished after 18 timesteps with reward 18.00
Episode 6 finished after 26 timesteps with reward 26.00
Episode 7 finished after 39 timesteps with reward 39.00
Episode 8 finished after 39 timesteps with reward 39.00
Episode 9 finished after 31 timesteps with reward 31.00
Episode 10 finished after 33 timesteps with reward 33.00
Target network updated at episode 10
Episode 11 finished after 29 timesteps with reward 29.00
Episode 12 finished after 11 timesteps with reward 11.00
Episode 13 finished after 11 timesteps with reward 11.00
Episode 14 finished after 12 timesteps with reward 12.00
Episode 15 finished after 31 timesteps with reward 31.00
Episode 16 finished after 16 timesteps with reward 16.00
Episode 17 finished after 13 timesteps with reward 13.00
Episode 18 finished after 9 timesteps with reward 9.00
Episode 19 finished after 11 timesteps with reward 11.00
Episode 20 finished after 10 timesteps with reward 10.00
Target network updated at episode 20
Episode 21 finished after 8 timesteps with reward 8.00
Episode 22 finished after 10 timesteps with reward 10.00
Episode 23 finished after 10 timesteps with reward 10.00
Episode 24 finished after 13 timesteps with reward 13.00
Episode 25 finished after 14 timesteps with reward 14.00
Episode 26 finished after 9 timesteps with reward 9.00
Episode 27 finished after 13 timesteps with reward 13.00
Episode 28 finished after 12 timesteps with reward 12.00
Episode 29 finished after 16 timesteps with reward 16.00
Episode 30 finished after 9 timesteps with reward 9.00
Target network updated at episode 30
Episode 31 finished after 14 timesteps with reward 14.00
Episode 32 finished after 19 timesteps with reward 19.00
Episode 33 finished after 17 timesteps with reward 17.00
Episode 34 finished after 14 timesteps with reward 14.00
Episode 35 finished after 11 timesteps with reward 11.00
Episode 36 finished after 9 timesteps with reward 9.00
Episode 37 finished after 18 timesteps with reward 18.00
Episode 38 finished after 10 timesteps with reward 10.00
Episode 39 finished after 10 timesteps with reward 10.00
Episode 40 finished after 13 timesteps with reward 13.00
Target network updated at episode 40
Episode 41 finished after 15 timesteps with reward 15.00
Episode 42 finished after 12 timesteps with reward 12.00
Episode 43 finished after 10 timesteps with reward 10.00
Episode 44 finished after 10 timesteps with reward 10.00
Episode 45 finished after 12 timesteps with reward 12.00
Episode 46 finished after 10 timesteps with reward 10.00
Episode 47 finished after 13 timesteps with reward 13.00
Episode 48 finished after 9 timesteps with reward 9.00
Episode 49 finished after 10 timesteps with reward 10.00
Episode 50 finished after 10 timesteps with reward 10.00
Target network updated at episode 50
Episode 51 finished after 8 timesteps with reward 8.00
Episode 52 finished after 11 timesteps with reward 11.00
Episode 53 finished after 11 timesteps with reward 11.00
Episode 54 finished after 10 timesteps with reward 10.00
Episode 55 finished after 9 timesteps with reward 9.00
Episode 56 finished after 10 timesteps with reward 10.00
Episode 57 finished after 12 timesteps with reward 12.00
Episode 58 finished after 15 timesteps with reward 15.00
Episode 59 finished after 13 timesteps with reward 13.00
Episode 60 finished after 9 timesteps with reward 9.00
Target network updated at episode 60
Episode 61 finished after 12 timesteps with reward 12.00
Episode 62 finished after 11 timesteps with reward 11.00
Episode 63 finished after 16 timesteps with reward 16.00
Episode 64 finished after 10 timesteps with reward 10.00
Episode 65 finished after 10 timesteps with reward 10.00
Episode 66 finished after 13 timesteps with reward 13.00
Episode 67 finished after 15 timesteps with reward 15.00
Episode 68 finished after 10 timesteps with reward 10.00
Episode 69 finished after 9 timesteps with reward 9.00
Episode 70 finished after 10 timesteps with reward 10.00
Target network updated at episode 70
Episode 71 finished after 8 timesteps with reward 8.00
Episode 72 finished after 18 timesteps with reward 18.00
Episode 73 finished after 10 timesteps with reward 10.00
Episode 74 finished after 11 timesteps with reward 11.00
Episode 75 finished after 11 timesteps with reward 11.00
Episode 76 finished after 10 timesteps with reward 10.00
Episode 77 finished after 12 timesteps with reward 12.00
Episode 78 finished after 10 timesteps with reward 10.00
Episode 79 finished after 11 timesteps with reward 11.00
Episode 80 finished after 10 timesteps with reward 10.00
Target network updated at episode 80
Episode 81 finished after 13 timesteps with reward 13.00
Episode 82 finished after 10 timesteps with reward 10.00
Episode 83 finished after 10 timesteps with reward 10.00
Episode 84 finished after 12 timesteps with reward 12.00
Episode 85 finished after 10 timesteps with reward 10.00
Episode 86 finished after 12 timesteps with reward 12.00
Episode 87 finished after 10 timesteps with reward 10.00
Episode 88 finished after 9 timesteps with reward 9.00
Episode 89 finished after 14 timesteps with reward 14.00
Episode 90 finished after 13 timesteps with reward 13.00
Target network updated at episode 90
Episode 91 finished after 20 timesteps with reward 20.00
Episode 92 finished after 12 timesteps with reward 12.00
Episode 93 finished after 12 timesteps with reward 12.00
Episode 94 finished after 9 timesteps with reward 9.00
Episode 95 finished after 11 timesteps with reward 11.00
Episode 96 finished after 12 timesteps with reward 12.00
Episode 97 finished after 11 timesteps with reward 11.00
Episode 98 finished after 8 timesteps with reward 8.00
Episode 99 finished after 10 timesteps with reward 10.00
Episode 100 finished after 11 timesteps with reward 11.00
Episode 100 complete with total reward 11.00
Target network updated at episode 100
Episode 101 finished after 13 timesteps with reward 13.00
Episode 102 finished after 10 timesteps with reward 10.00
Episode 103 finished after 11 timesteps with reward 11.00
Episode 104 finished after 10 timesteps with reward 10.00
Episode 105 finished after 12 timesteps with reward 12.00
Episode 106 finished after 8 timesteps with reward 8.00
Episode 107 finished after 11 timesteps with reward 11.00
Episode 108 finished after 12 timesteps with reward 12.00
Episode 109 finished after 12 timesteps with reward 12.00
Episode 110 finished after 12 timesteps with reward 12.00
Target network updated at episode 110
Episode 111 finished after 13 timesteps with reward 13.00
Episode 112 finished after 11 timesteps with reward 11.00
Episode 113 finished after 11 timesteps with reward 11.00
Episode 114 finished after 9 timesteps with reward 9.00
Episode 115 finished after 9 timesteps with reward 9.00
Episode 116 finished after 9 timesteps with reward 9.00
Episode 117 finished after 10 timesteps with reward 10.00
Episode 118 finished after 11 timesteps with reward 11.00
Episode 119 finished after 10 timesteps with reward 10.00
Episode 120 finished after 12 timesteps with reward 12.00
Target network updated at episode 120
Episode 121 finished after 9 timesteps with reward 9.00
Episode 122 finished after 10 timesteps with reward 10.00
Episode 123 finished after 9 timesteps with reward 9.00
Episode 124 finished after 13 timesteps with reward 13.00
Episode 125 finished after 13 timesteps with reward 13.00
Episode 126 finished after 12 timesteps with reward 12.00
Episode 127 finished after 14 timesteps with reward 14.00
Episode 128 finished after 14 timesteps with reward 14.00
Episode 129 finished after 11 timesteps with reward 11.00
Episode 130 finished after 11 timesteps with reward 11.00
Target network updated at episode 130
Episode 131 finished after 12 timesteps with reward 12.00
Episode 132 finished after 10 timesteps with reward 10.00
Episode 133 finished after 10 timesteps with reward 10.00
Episode 134 finished after 17 timesteps with reward 17.00
Episode 135 finished after 15 timesteps with reward 15.00
Episode 136 finished after 19 timesteps with reward 19.00
Episode 137 finished after 20 timesteps with reward 20.00
Episode 138 finished after 15 timesteps with reward 15.00
Episode 139 finished after 13 timesteps with reward 13.00
Episode 140 finished after 16 timesteps with reward 16.00
Target network updated at episode 140
Episode 141 finished after 11 timesteps with reward 11.00
Episode 142 finished after 19 timesteps with reward 19.00
Episode 143 finished after 17 timesteps with reward 17.00
Episode 144 finished after 20 timesteps with reward 20.00
Episode 145 finished after 21 timesteps with reward 21.00
Episode 146 finished after 25 timesteps with reward 25.00
Episode 147 finished after 19 timesteps with reward 19.00
Episode 148 finished after 23 timesteps with reward 23.00
Episode 149 finished after 21 timesteps with reward 21.00
Episode 150 finished after 23 timesteps with reward 23.00
Target network updated at episode 150
Episode 151 finished after 22 timesteps with reward 22.00
Episode 152 finished after 29 timesteps with reward 29.00
Episode 153 finished after 19 timesteps with reward 19.00
Episode 154 finished after 25 timesteps with reward 25.00
Episode 155 finished after 19 timesteps with reward 19.00
Episode 156 finished after 20 timesteps with reward 20.00
Episode 157 finished after 25 timesteps with reward 25.00
Episode 158 finished after 33 timesteps with reward 33.00
Episode 159 finished after 38 timesteps with reward 38.00
Episode 160 finished after 30 timesteps with reward 30.00
Target network updated at episode 160
Episode 161 finished after 29 timesteps with reward 29.00
Episode 162 finished after 40 timesteps with reward 40.00
Episode 163 finished after 24 timesteps with reward 24.00
Episode 164 finished after 26 timesteps with reward 26.00
Episode 165 finished after 43 timesteps with reward 43.00
Episode 166 finished after 45 timesteps with reward 45.00
Episode 167 finished after 48 timesteps with reward 48.00
Episode 168 finished after 36 timesteps with reward 36.00
Episode 169 finished after 33 timesteps with reward 33.00
Episode 170 finished after 41 timesteps with reward 41.00
Target network updated at episode 170
Episode 171 finished after 34 timesteps with reward 34.00
Episode 172 finished after 35 timesteps with reward 35.00
Episode 173 finished after 29 timesteps with reward 29.00
Episode 174 finished after 32 timesteps with reward 32.00
Episode 175 finished after 31 timesteps with reward 31.00
Episode 176 finished after 59 timesteps with reward 59.00
Episode 177 finished after 67 timesteps with reward 67.00
Episode 178 finished after 80 timesteps with reward 80.00
Episode 179 finished after 91 timesteps with reward 91.00
Episode 180 finished after 105 timesteps with reward 105.00
Target network updated at episode 180
Episode 181 finished after 89 timesteps with reward 89.00
Episode 182 finished after 124 timesteps with reward 124.00
Episode 183 finished after 102 timesteps with reward 102.00
Episode 184 finished after 167 timesteps with reward 167.00
Episode 185 finished after 163 timesteps with reward 163.00
Episode 186 finished after 278 timesteps with reward 278.00
Episode 187 finished after 124 timesteps with reward 124.00
Episode 188 finished after 273 timesteps with reward 273.00
Episode 189 finished after 137 timesteps with reward 137.00
Episode 190 finished after 300 timesteps with reward 300.00
Target network updated at episode 190
Episode 191 finished after 224 timesteps with reward 224.00
Episode 192 finished after 208 timesteps with reward 208.00
Episode 193 finished after 227 timesteps with reward 227.00
Episode 194 finished after 262 timesteps with reward 262.00
Episode 195 finished after 321 timesteps with reward 321.00
Episode 196 finished after 305 timesteps with reward 305.00
Episode 197 finished after 203 timesteps with reward 203.00
Episode 198 finished after 265 timesteps with reward 265.00
Episode 199 finished after 181 timesteps with reward 181.00
Episode 200 finished after 166 timesteps with reward 166.00
Episode 200 complete with total reward 166.00
Target network updated at episode 200
Episode 201 finished after 159 timesteps with reward 159.00
Episode 202 finished after 244 timesteps with reward 244.00
Episode 203 finished after 231 timesteps with reward 231.00
Episode 204 finished after 208 timesteps with reward 208.00
Episode 205 finished after 196 timesteps with reward 196.00
Episode 206 finished after 164 timesteps with reward 164.00
Episode 207 finished after 319 timesteps with reward 319.00
Episode 208 finished after 176 timesteps with reward 176.00
Episode 209 finished after 201 timesteps with reward 201.00
Episode 210 finished after 265 timesteps with reward 265.00
Target network updated at episode 210
Episode 211 finished after 272 timesteps with reward 272.00
Episode 212 finished after 161 timesteps with reward 161.00
Episode 213 finished after 211 timesteps with reward 211.00
Episode 214 finished after 212 timesteps with reward 212.00
Episode 215 finished after 195 timesteps with reward 195.00
Episode 216 finished after 184 timesteps with reward 184.00
Episode 217 finished after 193 timesteps with reward 193.00
Episode 218 finished after 417 timesteps with reward 417.00
Episode 219 finished after 179 timesteps with reward 179.00
Episode 220 finished after 176 timesteps with reward 176.00
Target network updated at episode 220
Episode 221 finished after 170 timesteps with reward 170.00
Episode 222 finished after 275 timesteps with reward 275.00
Episode 223 finished after 256 timesteps with reward 256.00
Episode 224 finished after 184 timesteps with reward 184.00
Episode 225 finished after 184 timesteps with reward 184.00
Episode 226 finished after 247 timesteps with reward 247.00
Episode 227 finished after 178 timesteps with reward 178.00
Episode 228 finished after 223 timesteps with reward 223.00
Episode 229 finished after 192 timesteps with reward 192.00
Episode 230 finished after 182 timesteps with reward 182.00
Target network updated at episode 230
Episode 231 finished after 172 timesteps with reward 172.00
Episode 232 finished after 161 timesteps with reward 161.00
Episode 233 finished after 195 timesteps with reward 195.00
Episode 234 finished after 179 timesteps with reward 179.00
Episode 235 finished after 181 timesteps with reward 181.00
Episode 236 finished after 241 timesteps with reward 241.00
Episode 237 finished after 204 timesteps with reward 204.00
Episode 238 finished after 155 timesteps with reward 155.00
Episode 239 finished after 206 timesteps with reward 206.00
Episode 240 finished after 201 timesteps with reward 201.00
Target network updated at episode 240
Episode 241 finished after 177 timesteps with reward 177.00
Episode 242 finished after 188 timesteps with reward 188.00
Episode 243 finished after 180 timesteps with reward 180.00
Episode 244 finished after 160 timesteps with reward 160.00
Episode 245 finished after 242 timesteps with reward 242.00
Episode 246 finished after 210 timesteps with reward 210.00
Episode 247 finished after 169 timesteps with reward 169.00
Episode 248 finished after 174 timesteps with reward 174.00
Episode 249 finished after 206 timesteps with reward 206.00
Episode 250 finished after 172 timesteps with reward 172.00
Target network updated at episode 250
Episode 251 finished after 184 timesteps with reward 184.00
Episode 252 finished after 163 timesteps with reward 163.00
Episode 253 finished after 178 timesteps with reward 178.00
Episode 254 finished after 191 timesteps with reward 191.00
Episode 255 finished after 192 timesteps with reward 192.00
Episode 256 finished after 193 timesteps with reward 193.00
Episode 257 finished after 164 timesteps with reward 164.00
Episode 258 finished after 176 timesteps with reward 176.00
Episode 259 finished after 202 timesteps with reward 202.00
Episode 260 finished after 163 timesteps with reward 163.00
Target network updated at episode 260
Episode 261 finished after 187 timesteps with reward 187.00
Episode 262 finished after 172 timesteps with reward 172.00
Episode 263 finished after 174 timesteps with reward 174.00
Episode 264 finished after 157 timesteps with reward 157.00
Traceback (most recent call last):
  File "D:\code\python\Simple_Reinforcement_Learning\6.DQN算法\QDN_simple.py", line 164, in <module>
    trainer.train()
  File "D:\code\python\Simple_Reinforcement_Learning\6.DQN算法\QDN_simple.py", line 143, in train
    self.optimize_model()
  File "D:\code\python\Simple_Reinforcement_Learning\6.DQN算法\QDN_simple.py", line 100, in optimize_model
    non_final_next_states = torch.cat([s for s in batch.next_state if s is not None])
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

Process finished with exit code -1073741510 (0xC000013A: interrupted by Ctrl+C)
